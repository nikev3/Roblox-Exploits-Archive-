---[[
Server Side Part of the IBM thing
--]]
local BlinkingThing="â–®"
local Remotes=game.ReplicatedStorage.IBM7094
local FireIBMServer=game.ReplicatedStorage.IBM7094.FireIBMServer
local GlobalConfig=require(Remotes.GlobalConfig)
local IsBlinking=true
local BlinkVisible

local Prompt=script.Parent.Parent.ProximityPrompt
local Text = script.Parent.TextLabel----The text
Text.TextXAlignment = Enum.TextXAlignment.Left
Text.Text=""
Prompt.KeyboardKeyCode=GlobalConfig.InteractionKey
Prompt.ObjectText="Use Computer"
function SFXType()
	local SFX=script.Parent.Parent.SFX:GetChildren()
	local RandomSound=SFX[math.random(1,table.maxn(SFX))]
	RandomSound:Play()
end

function Blink()
spawn(function()
	while true do
		if IsBlinking then
				Text.Text=Text.Text..BlinkingThing
				BlinkVisible=true---Adds the rectangle to text
				wait(0.1)
				BlinkVisible=false
			Text.Text=Text.Text:gsub("%"..BlinkingThing,"")----removes rectangle from text	
			wait(0.1)
			
		else
			wait(0.1)
			Text.Text=Text.Text:gsub("%"..BlinkingThing,"")
			break
		end
	
	end
	end)


end






function AnimateText(TextData,ClearText)
	-------PreStart
	
	
	if ClearText then Text.Text="" end
	-------Start
	local t={}
	local str=TextData
	str:gsub(".",function(c) table.insert(t,c) end)
	for i,v in pairs(t) do
		Text.Text=Text.Text..v
		wait(0.1)
	end
	
	
	
	------------
	
	--------
end
local LastCharacter=""
FireIBMServer.OnServerEvent:Connect(function(plr,text,specialchar,Enable)
	
	text=tostring(text)
	if text=="10" then
		AnimateText(tostring(0))
	else
		AnimateText(text)
	end
	if Enable then 
	if GlobalConfig.ClearTextOnLeave then IsBlinking=false Blink() wait(0.1) Text.Text="" end	
		
	Prompt.Enabled=Enable end
	SFXType()
end)
game.ReplicatedStorage.IBM7094.Backspace.OnServerEvent:Connect(function()
	if BlinkVisible then
		Text.Text=Text.Text:sub(  1,-5 )
	else Text.Text=Text.Text:sub(  1,-2 )
	end
	SFXType()
end)
local UseComputer=Remotes.UseComputer

Prompt.Triggered:Connect(function(Player)
	
	UseComputer:FireClient(Player, script.Parent.Parent.Parent.Parent.Parent)
	IsBlinking=true
	Prompt.Enabled=false
	Blink()
	
end)






	


